'use strict';var _0x346f=['txservicecharge','Client','connecting\x20to\x20database\x20...','\x0a\x09\x09SELECT\x20\x0a\x09\x09DISTINCT\x20\x0a\x09\x09\x09','table_name',')\x20as\x20item_qty,\x0a\x09\x09\x09\x09\x09','done.\x0d\x0a','\x20as\x20tx_date\x0a\x09\x09FROM\x20\x0a\x09\x09\x09','join','\x0a\x09\x09','itemsubtotal','user','\x0a\x09\x09\x09\x09WHERE\x0a\x09\x09\x09\x09\x09','itemtax','Connected.\x0d\x0a','limit','\x0a\x09\x09\x09','\x0a\x09\x09\x09\x09SELECT\x0a\x09\x09\x09\x09\x09\x27\x27\x20as\x20payment_id,\x20\x0a\x09\x09\x09\x09\x09\x27\x27\x20as\x20payment_method,\x0a\x09\x09\x09\x09\x09','55QPGuKX','assign','\x20as\x20payment_id,\x20\x0a\x09\x09\x09\x09\x09','\x20as\x20tx_id,\x0a\x09\x09\x09','\x20=\x20$1\x0a\x09\x09\x09','itemqty','1164792pDAEJk','push','server','database','\x20>=\x20\x27','schema','\x27\x0a\x09\x09\x09AND\x20table_name\x20\x20\x20=\x20\x27','\x0a\x09\x09\x09\x09SELECT\x20\x0a\x09\x09\x09\x09\x09','rows','\x20as\x20','\x20as\x20tx_date,\x0a\x09\x09\x09','database\x20is\x20not\x20connnected.\x0d\x0a','690202dShcTp','tx_void','\x0a\x09\x09\x09\x09SELECT\x0a\x09\x09\x09\x09\x09','end','1RAHaUb','txdate','\x0a\x09\x09WHERE\x0a\x09\x09\x09',')\x20as\x20item_taxvalue\x09\x0a\x09\x09\x09\x09FROM\x20\x0a\x09\x09\x09\x09\x09','already\x20connnected\x0d\x0a','password','fields','error','closing\x20connection...\x20','table_id','996001bBCyXT','19595xRMRUi','stdout','items','\x20as\x20payment_method,\x0a\x09\x09\x09\x09\x09','payments','config','\x20=\x20$1\x0a\x09','write','public','2443788jtELpF',')\x20as\x20payment_value\x0a\x09\x09\x09\x09FROM\x20\x0a\x09\x09\x09\x09\x09','conn','\x27\x0a\x09\x09ORDER\x20BY\x20','\x0a\x09\x09\x09SELECT\x20column_name\x0a\x09\x09\x09FROM\x20information_schema.columns\x0a\x09\x09\x09WHERE\x20table_schema\x20=\x20\x27','\x20as\x20tx_servicecharge,\x0a\x09\x09\x09','\x0a\x09\x09\x09LIMIT\x20','host','tx_id','port','\x27\x0a\x09\x09\x09ORDER\x20BY\x20column_name\x20\x20\x0a\x09\x09','model','268182frEDiw','tablename','\x27\x0a\x09\x09\x09ORDER\x20BY\x20table_name\x09\x09\x0a\x09\x09',')\x20as\x20item_subtotal,\x0a\x09\x09\x09\x09\x09','\x0a\x09\x09SELECT\x20\x0a\x09\x09DISTINCT\x0a\x09\x09\x09\x27','_connected','\x20as\x20item_id,\x0a\x09\x09\x09\x09\x09','header','1hSLrFU','itemname','schema1','field_name','1261947tyJjbN','(SUM(','txid','\x20as\x20tx_void\x0a\x09\x09FROM\x20\x0a\x09\x09\x09','exports','\x20=\x20$1\x0a\x09\x09\x09\x09group\x20by\x20','\x20as\x20item_name,\x0a\x09\x09\x09\x09\x09','\x0a\x09\x09\x09SELECT\x20table_name\x0a\x09\x09\x09FROM\x20information_schema.tables\x0a\x09\x09\x09WHERE\x20table_schema=\x27','postgres://','1jwmdQC'];var _0x3779=function(_0x1e1455,_0x366572){_0x1e1455=_0x1e1455-0x11f;var _0x346f75=_0x346f[_0x1e1455];return _0x346f75;};var _0x3c306e=_0x3779;(function(_0x186b89,_0x2d6e09){var _0xc04831=_0x3779;while(!![]){try{var _0x9dc67e=parseInt(_0xc04831(0x146))+parseInt(_0xc04831(0x134))*-parseInt(_0xc04831(0x155))+parseInt(_0xc04831(0x176))+-parseInt(_0xc04831(0x14a))*-parseInt(_0xc04831(0x16a))+parseInt(_0xc04831(0x13a))*parseInt(_0xc04831(0x172))+-parseInt(_0xc04831(0x154))*-parseInt(_0xc04831(0x121))+-parseInt(_0xc04831(0x15e));if(_0x9dc67e===_0x2d6e09)break;else _0x186b89['push'](_0x186b89['shift']());}catch(_0x497bb5){_0x186b89['push'](_0x186b89['shift']());}}}(_0x346f,0xd1ddb));const drivers=require('../src/drivers.js'),pg=require('pg');module[_0x3c306e(0x17a)]=_0x3f8328=>{var _0x36f9ba=_0x3c306e,_0x247a8d={'_connected':![],'config':_0x3f8328,'conn':{}};return Object[_0x36f9ba(0x135)](drivers['CreateInterface'](),{'connect':async()=>{await pg_connect(_0x247a8d);},'close':async()=>{await pg_close(_0x247a8d);},'setup_get_tables':async()=>{return await setup_get_tables(_0x247a8d);},'setup_get_fields':async _0x43aa29=>{return await setup_get_fields(_0x247a8d,_0x43aa29);},'previewtable':async _0x5699d1=>{return await previewtable(_0x247a8d,_0x5699d1);},'tx_get_latest_rows':async()=>{return await tx_get_latest_rows(_0x247a8d);},'tx_get_data':async _0x47804f=>{return await tx_get_data(_0x247a8d,_0x47804f);},'setConfig':_0x387dcd=>{_0x247a8d['conf']=_0x387dcd;}});};async function pg_connect(_0x10c1ac){var _0x5903dd=_0x3c306e;if(_0x10c1ac[_0x5903dd(0x16f)]){process['stdout'][_0x5903dd(0x15c)](_0x5903dd(0x14e));return;}var _0x5dc145=_0x10c1ac[_0x5903dd(0x15a)][_0x5903dd(0x13c)],_0x5c751f;if(_0x5dc145[_0x5903dd(0x167)]==''||_0x5dc145[_0x5903dd(0x167)]=='0'||_0x5dc145[_0x5903dd(0x167)]==0x0||_0x5dc145['port']==null)var _0x5c751f=_0x5903dd(0x120)+_0x5dc145[_0x5903dd(0x12d)]+':'+_0x5dc145[_0x5903dd(0x14f)]+'@'+_0x5dc145['host']+'/'+_0x5dc145[_0x5903dd(0x13d)];else var _0x5c751f=_0x5903dd(0x120)+_0x5dc145['user']+':'+_0x5dc145[_0x5903dd(0x14f)]+'@'+_0x5dc145[_0x5903dd(0x165)]+':'+_0x5dc145[_0x5903dd(0x167)]+'/'+_0x5dc145[_0x5903dd(0x13d)];return _0x10c1ac[_0x5903dd(0x160)]=new pg[(_0x5903dd(0x123))](_0x5c751f),new Promise((_0xc058d6,_0x56aea1)=>{var _0x1f592c=_0x5903dd;process['stdout'][_0x1f592c(0x15c)](_0x1f592c(0x124)),_0x10c1ac[_0x1f592c(0x160)]['connect'](_0x1a6279=>{var _0x120a2f=_0x1f592c;_0x1a6279?_0x56aea1(_0x1a6279):(_0x10c1ac[_0x120a2f(0x16f)]=!![],process[_0x120a2f(0x156)]['write'](_0x120a2f(0x130)),_0xc058d6(!![]));});});}async function pg_close(_0x3efd6a){var _0x43cdb3=_0x3c306e;if(!_0x3efd6a[_0x43cdb3(0x16f)]){process['stdout'][_0x43cdb3(0x15c)](_0x43cdb3(0x145));return;}return new Promise((_0x949c65,_0x4743db)=>{var _0x507025=_0x43cdb3;process[_0x507025(0x156)][_0x507025(0x15c)](_0x507025(0x152)),_0x3efd6a[_0x507025(0x160)][_0x507025(0x149)](_0x148d16=>{var _0x46b127=_0x507025;_0x148d16?_0x4743db(_0x148d16):(process['stdout'][_0x46b127(0x15c)](_0x46b127(0x128)),_0x3efd6a[_0x46b127(0x160)][_0x46b127(0x149)](),_0x949c65(!![]));});});}async function pg_query(_0x26e11a,_0x27209b,_0x51138f){var _0xdb33c8=_0x3c306e;if(!_0x26e11a[_0xdb33c8(0x16f)]){process[_0xdb33c8(0x156)][_0xdb33c8(0x15c)](_0xdb33c8(0x145));return;}return new Promise((_0x35eba0,_0x350a05)=>{var _0x45ab21=_0xdb33c8;_0x26e11a[_0x45ab21(0x160)]['query'](_0x27209b,_0x51138f,(_0x545cc0,_0x571585)=>{var _0x1c3ebc=_0x45ab21;if(_0x545cc0)_0x350a05(_0x545cc0);else{var _0x5f5e05=[];for(var _0x7e5afc of _0x571585[_0x1c3ebc(0x142)]){var _0x469424={};for(var _0x233303 in _0x7e5afc){_0x469424[_0x233303]=_0x7e5afc[_0x233303];}_0x5f5e05['push'](_0x469424);}_0x35eba0(_0x5f5e05);}});});}async function setup_get_tables(_0x30fc26){var _0xb916d0=_0x3c306e;try{var _0x82122e=_0x30fc26[_0xb916d0(0x15a)][_0xb916d0(0x13c)][_0xb916d0(0x13f)]!=''?_0x30fc26['config'][_0xb916d0(0x13c)][_0xb916d0(0x13f)]:_0xb916d0(0x15d),_0x26f023=_0xb916d0(0x11f)+_0x82122e+_0xb916d0(0x16c),_0x387225=await pg_query(_0x30fc26,_0x26f023,[]),_0x4d27de=[];for(var _0x17e00d of _0x387225){var _0x47dc57={};for(var _0x46b511 in _0x17e00d){_0x47dc57[_0xb916d0(0x153)]=_0x17e00d[_0x46b511],_0x47dc57[_0xb916d0(0x126)]=_0x17e00d[_0x46b511];break;}_0x4d27de[_0xb916d0(0x13b)](_0x47dc57);}return _0x4d27de;}catch(_0x5937b5){throw _0x5937b5;}}async function setup_get_fields(_0x2e3b37,_0x251b0e){var _0x218cf9=_0x3c306e;try{var _0x3281ff=_0x2e3b37[_0x218cf9(0x15a)]['server'][_0x218cf9(0x13f)]!=''?_0x2e3b37[_0x218cf9(0x15a)][_0x218cf9(0x13c)][_0x218cf9(0x13f)]:'public',_0x26b584=_0x218cf9(0x162)+_0x3281ff+_0x218cf9(0x140)+_0x251b0e+_0x218cf9(0x168),_0x50b25d=await pg_query(_0x2e3b37,_0x26b584,[]),_0x14a092=[];for(var _0x435ed3 of _0x50b25d){var _0x3d02b5={};for(var _0x2e4d1d in _0x435ed3){_0x3d02b5['field_id']=_0x435ed3[_0x2e4d1d],_0x3d02b5[_0x218cf9(0x175)]=_0x435ed3[_0x2e4d1d];break;}_0x14a092['push'](_0x3d02b5);}return _0x14a092;}catch(_0x2e252f){throw _0x2e252f;}}async function tx_get_latest_rows(_0x5cc6ef){var _0x2d8fc8=_0x3c306e,_0x5ea5bd=_0x5cc6ef[_0x2d8fc8(0x15a)]['lastfetchdate'],_0x365abf=_0x2d8fc8(0x125)+_0x5cc6ef['config']['schema']['header']['fields']['txid']+'\x20as\x20tx_id,\x0a\x09\x09\x09'+_0x5cc6ef[_0x2d8fc8(0x15a)][_0x2d8fc8(0x13f)][_0x2d8fc8(0x171)][_0x2d8fc8(0x150)][_0x2d8fc8(0x14b)]+_0x2d8fc8(0x129)+_0x5cc6ef['config'][_0x2d8fc8(0x13f)]['header'][_0x2d8fc8(0x16b)]+_0x2d8fc8(0x14c)+_0x5cc6ef['config'][_0x2d8fc8(0x13f)][_0x2d8fc8(0x171)][_0x2d8fc8(0x150)]['txdate']+_0x2d8fc8(0x13e)+_0x5ea5bd+_0x2d8fc8(0x161)+_0x5cc6ef['config'][_0x2d8fc8(0x13f)][_0x2d8fc8(0x171)][_0x2d8fc8(0x150)]['txdate']+'\x20\x20ASC\x09\x0a\x09';try{var _0x103c9e=await pg_query(_0x5cc6ef,_0x365abf);return _0x103c9e;}catch(_0x340f64){console[_0x2d8fc8(0x151)](_0x340f64);throw _0x340f64;}}async function tx_get_data(_0x519aab,_0x5e8685){try{var _0x22b198=await tx_get_data_header(_0x519aab,_0x5e8685),_0x57f50a=await tx_get_data_items(_0x519aab,_0x5e8685,_0x22b198),_0x12df07=await tx_get_data_payments(_0x519aab,_0x5e8685,_0x22b198);return{'header':_0x22b198,'items':_0x57f50a,'payments':_0x12df07};}catch(_0x45c05f){throw _0x45c05f;}}async function tx_get_data_header(_0x34e5c4,_0x552e0f){var _0x4b5938=_0x3c306e,_0x346bf4=_0x4b5938(0x16e)+_0x34e5c4[_0x4b5938(0x15a)]['tenant_id']+'\x27\x20as\x20site_id,\x0a\x09\x09\x09'+_0x34e5c4[_0x4b5938(0x15a)]['schema'][_0x4b5938(0x171)][_0x4b5938(0x150)][_0x4b5938(0x178)]+_0x4b5938(0x137)+_0x34e5c4[_0x4b5938(0x15a)][_0x4b5938(0x13f)][_0x4b5938(0x171)]['fields'][_0x4b5938(0x14b)]+_0x4b5938(0x144)+_0x34e5c4[_0x4b5938(0x15a)][_0x4b5938(0x13f)][_0x4b5938(0x171)][_0x4b5938(0x150)][_0x4b5938(0x122)]+_0x4b5938(0x163)+_0x34e5c4['config']['schema'][_0x4b5938(0x171)][_0x4b5938(0x150)]['txisvoid']+_0x4b5938(0x179)+_0x34e5c4['config']['schema'][_0x4b5938(0x171)][_0x4b5938(0x16b)]+_0x4b5938(0x14c)+_0x34e5c4[_0x4b5938(0x15a)]['schema']['header'][_0x4b5938(0x150)][_0x4b5938(0x178)]+_0x4b5938(0x15b);try{var _0x2bfc20=await pg_query(_0x34e5c4,_0x346bf4,[_0x552e0f[_0x4b5938(0x166)]]),_0x445e0e=_0x2bfc20[0x0];return _0x445e0e;}catch(_0x334800){throw _0x334800;}}async function tx_get_data_items(_0x375ca7,_0x3dcd43,_0xcc2428){var _0xad8df0=_0x3c306e,_0x2c3eac=_0x375ca7['config'][_0xad8df0(0x13f)][_0xad8df0(0x169)];try{var _0x5586f9;_0xcc2428[_0xad8df0(0x147)]==0x1||_0xcc2428[_0xad8df0(0x147)]==!![]?_0x5586f9='-':_0x5586f9='';var _0x781329;_0x2c3eac==_0xad8df0(0x174)?_0x781329='\x0a\x09\x09\x09\x09SELECT\x20\x0a\x09\x09\x09\x09\x09'+_0x375ca7[_0xad8df0(0x15a)][_0xad8df0(0x13f)][_0xad8df0(0x171)]['fields'][_0xad8df0(0x173)]+_0xad8df0(0x170)+_0x375ca7[_0xad8df0(0x15a)][_0xad8df0(0x13f)][_0xad8df0(0x171)]['fields']['itemname']+_0xad8df0(0x17c)+_0x5586f9+'('+_0x375ca7[_0xad8df0(0x15a)][_0xad8df0(0x13f)]['header']['fields'][_0xad8df0(0x139)]+_0xad8df0(0x127)+_0x5586f9+'('+_0x375ca7[_0xad8df0(0x15a)][_0xad8df0(0x13f)][_0xad8df0(0x171)]['fields']['itemsubtotal']+_0xad8df0(0x16d)+_0x5586f9+'('+_0x375ca7['config']['schema'][_0xad8df0(0x171)][_0xad8df0(0x150)]['itemtax']+')\x20as\x20item_taxvalue\x09\x0a\x09\x09\x09\x09FROM\x20\x0a\x09\x09\x09\x09\x09'+_0x375ca7['config']['schema'][_0xad8df0(0x171)][_0xad8df0(0x16b)]+_0xad8df0(0x12e)+_0x375ca7[_0xad8df0(0x15a)]['schema'][_0xad8df0(0x171)]['fields'][_0xad8df0(0x178)]+_0xad8df0(0x138):_0x781329=_0xad8df0(0x141)+_0x375ca7['config'][_0xad8df0(0x13f)][_0xad8df0(0x157)][_0xad8df0(0x150)][_0xad8df0(0x173)]+_0xad8df0(0x170)+_0x375ca7[_0xad8df0(0x15a)][_0xad8df0(0x13f)][_0xad8df0(0x157)][_0xad8df0(0x150)][_0xad8df0(0x173)]+_0xad8df0(0x17c)+_0x5586f9+'('+_0x375ca7[_0xad8df0(0x15a)][_0xad8df0(0x13f)][_0xad8df0(0x157)][_0xad8df0(0x150)][_0xad8df0(0x139)]+')\x20as\x20item_qty,\x0a\x09\x09\x09\x09\x09'+_0x5586f9+'('+_0x375ca7['config']['schema'][_0xad8df0(0x157)][_0xad8df0(0x150)][_0xad8df0(0x12c)]+_0xad8df0(0x16d)+_0x5586f9+'('+_0x375ca7[_0xad8df0(0x15a)]['schema'][_0xad8df0(0x157)][_0xad8df0(0x150)][_0xad8df0(0x12f)]+_0xad8df0(0x14d)+_0x375ca7['config'][_0xad8df0(0x13f)][_0xad8df0(0x157)][_0xad8df0(0x16b)]+_0xad8df0(0x12e)+_0x375ca7[_0xad8df0(0x15a)][_0xad8df0(0x13f)][_0xad8df0(0x157)]['fields'][_0xad8df0(0x178)]+_0xad8df0(0x138);var _0x4cf0f8=_0x781329,_0x42c870=await pg_query(_0x375ca7,_0x4cf0f8,[_0x3dcd43[_0xad8df0(0x166)]]);return _0x42c870;}catch(_0x3e06da){throw _0x3e06da;}}async function tx_get_data_payments(_0x3d281b,_0x1158ba,_0x52c90b){var _0x1606ab=_0x3c306e,_0x1970ef=_0x3d281b[_0x1606ab(0x15a)][_0x1606ab(0x13f)][_0x1606ab(0x169)];try{var _0x2308a1;_0x52c90b[_0x1606ab(0x147)]==0x1||_0x52c90b[_0x1606ab(0x147)]==!![]?_0x2308a1='-':_0x2308a1='';var _0x2f3d10;_0x1970ef=='schema1'?_0x2f3d10=_0x1606ab(0x133)+_0x2308a1+_0x1606ab(0x177)+_0x3d281b[_0x1606ab(0x15a)]['schema']['header'][_0x1606ab(0x150)]['itemsubtotal']+'))\x20as\x20payment_value\x0a\x09\x09\x09\x09FROM\x20\x0a\x09\x09\x09\x09\x09'+_0x3d281b[_0x1606ab(0x15a)][_0x1606ab(0x13f)][_0x1606ab(0x171)][_0x1606ab(0x16b)]+'\x0a\x09\x09\x09\x09WHERE\x0a\x09\x09\x09\x09\x09'+_0x3d281b[_0x1606ab(0x15a)][_0x1606ab(0x13f)]['header']['fields'][_0x1606ab(0x178)]+_0x1606ab(0x17b)+_0x3d281b[_0x1606ab(0x15a)][_0x1606ab(0x13f)][_0x1606ab(0x171)][_0x1606ab(0x150)]['txid']+_0x1606ab(0x132):_0x2f3d10=_0x1606ab(0x148)+_0x3d281b[_0x1606ab(0x15a)][_0x1606ab(0x13f)]['payments'][_0x1606ab(0x150)]['paymentname']+_0x1606ab(0x136)+_0x3d281b[_0x1606ab(0x15a)][_0x1606ab(0x13f)][_0x1606ab(0x159)][_0x1606ab(0x150)]['paymentname']+_0x1606ab(0x158)+_0x2308a1+'('+_0x3d281b[_0x1606ab(0x15a)]['schema'][_0x1606ab(0x159)][_0x1606ab(0x150)]['paymentvalue']+_0x1606ab(0x15f)+_0x3d281b[_0x1606ab(0x15a)]['schema'][_0x1606ab(0x159)][_0x1606ab(0x16b)]+_0x1606ab(0x12e)+_0x3d281b[_0x1606ab(0x15a)][_0x1606ab(0x13f)]['payments'][_0x1606ab(0x150)]['txid']+_0x1606ab(0x138);var _0x380db6=_0x2f3d10,_0x4f90b8=await pg_query(_0x3d281b,_0x380db6,[_0x1158ba[_0x1606ab(0x166)]]);return _0x4f90b8;}catch(_0x3a6bf1){throw _0x3a6bf1;}}async function previewtable(_0x141093,_0x1d56d9){var _0x1b44e2=_0x3c306e;try{var _0x774191=[];for(var _0x4474c4 in _0x1d56d9[_0x1b44e2(0x150)]){_0x774191[_0x1b44e2(0x13b)](_0x1d56d9[_0x1b44e2(0x150)][_0x4474c4]+_0x1b44e2(0x143)+_0x4474c4);}var _0x45d9b1=_0x774191[_0x1b44e2(0x12a)](',\x20'),_0x383b4b='\x0a\x09\x09\x09SELECT\x0a\x09\x09\x09'+_0x45d9b1+'\x0a\x09\x09\x09FROM\x0a\x09\x09\x09'+_0x1d56d9[_0x1b44e2(0x16b)]+_0x1b44e2(0x164)+_0x1d56d9[_0x1b44e2(0x131)]+_0x1b44e2(0x12b),_0x56d8e9=await pg_query(_0x141093,_0x383b4b,[]);return _0x56d8e9;}catch(_0x3432ae){throw _0x3432ae;}}